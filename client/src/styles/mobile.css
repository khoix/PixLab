/* 
 * Mobile-Specific Styles
 * Optimized for mobile devices (max-width: 767px)
 * These styles enhance the mobile experience with touch interactions,
 * mobile layouts, and mobile-optimized UI elements.
 */

@media (max-width: 767px) {
  /* Virtual Joystick Base Styles */
  /* The joystick component uses md:hidden, but these styles enhance it */
  .virtual-joystick-container {
    position: fixed;
    bottom: 2.5rem;
    left: 2.5rem;
    width: 8rem;
    height: 8rem;
    border-radius: 50%;
    border: 2px solid hsl(180 100% 50% / 0.3);
    background: hsl(0 0% 0% / 0.2);
    backdrop-filter: blur(4px);
    z-index: 50;
    touch-action: none;
    display: flex;
    align-items: center;
    justify-content: center;
    user-select: none;
    -webkit-user-select: none;
  }

  .virtual-joystick-handle {
    width: 3rem;
    height: 3rem;
    border-radius: 50%;
    background: hsl(180 100% 50% / 0.8);
    box-shadow: 0 0 15px rgba(0, 255, 245, 0.6);
    transition: transform 75ms;
    pointer-events: none;
  }

  /* Touch Interaction Optimizations */
  /* Prevent text selection on touch interactions */
  button, a, [role="button"], .touch-interactive {
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
    user-select: none;
    -webkit-user-select: none;
  }

  /* Ensure minimum touch target size (44x44px recommended) */
  button, a, [role="button"] {
    min-height: 44px;
  /*  min-width: 44px; */
  }

  /* Mobile Game UI Positioning */
  /* HUD optimizations for mobile */
  .game-hud {
    padding: 1rem;
    font-size: 0.75rem;
  }

  /* Move level HUD to bottom on mobile */
  /* Target the center level & timer section */
  /* Use fixed positioning to position relative to viewport, not parent */
  .level-hud {
    position: fixed !important;
    top: auto !important;
    bottom: 1rem !important; /* Position closer to bottom */
    left: auto !important;
    right: 70px !important; /* Move 10px to the right from center */
    transform: none !important;
    z-index: 40 !important; /* Ensure it's above canvas */
    gap: 0.25rem !important; /* Reduce gap between elements */
  }

  /* Make level badge smaller on mobile */
  .level-hud [class*="Badge"] {
    font-size: 0.625rem !important; /* Smaller than text-xs */
    padding: 0.25rem 0.5rem !important; /* Reduce padding from px-4 py-2 */
    line-height: 1.2 !important;
  }

  /* Make timer text smaller on mobile */
  .level-hud > div:not([class*="Badge"]) {
    font-size: 0.75rem !important; /* Smaller than text-lg */
    line-height: 1.2 !important;
  }

  /* Consumables panel mobile sizing */
  .consumables-panel {
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    min-width: auto;
    gap: 0.5rem !important;
  }

  /* Hide CONSUMABLES label on mobile */
  .consumables-panel > div:first-child {
    display: none !important;
  }

  /* Consumables panel mobile - icon only with stat shorthand */
  .consumable-button {
    min-width: auto !important;
    padding: 0 !important;
    border: none !important;
    background: transparent !important;
    align-items: center !important;
    justify-content: center !important;
    gap: 0.25rem !important;
  }

  .consumable-button:hover {
    background: transparent !important;
  }

  /* Hide consumable name on mobile */
  .consumable-name {
    display: none !important;
  }

  /* Show and style consumable icon on mobile */
  .consumable-icon-wrapper {
    display: flex !important;
    margin-bottom: 0;
  }

  .consumable-icon {
    width: 20px !important;
    height: 20px !important;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.8)) drop-shadow(0 0 8px currentColor);
  }

  /* Style stat shorthand on mobile - smaller and more compact */
  .consumable-stats {
    font-size: 0.625rem !important;
    line-height: 1.2;
    margin-top: 0;
    gap: 0 !important;
  }

  .consumable-stats > div {
    font-size: 0.625rem !important;
    line-height: 1.2;
  }

  /* Inventory dialog mobile sizing */
  .inventory-dialog {
    max-width: 90vw;
    max-height: 85vh;
  }

  /* Mobile-optimized spacing */
  /* Reduce padding on mobile for more screen space */
  .mobile-compact {
    padding: 0.75rem;
  }

  /* Mobile text sizing adjustments */
  /* Ensure text is readable but not too large on small screens */
  h1 {
    line-height: 1.2;
  }

  h2 {
    font-size: 1.25rem;
    line-height: 1.3;
  }

  /* Mobile card layouts */
  /* Stack cards vertically on mobile */
  .mobile-stack {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  /* Prevent horizontal scroll on mobile */
  body {
    overflow-x: hidden;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none; /* Firefox - hide scrollbar */
    -ms-overflow-style: none; /* IE and Edge - hide scrollbar */
    /* Fullscreen support */
    height: 100vh;
    height: 100dvh; /* Dynamic viewport height for mobile */
    min-height: 100vh;
    min-height: 100dvh;
    /* Safe area support for devices with notches */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  /* Ensure root element uses full viewport */
  #root {
    min-height: 100vh;
    min-height: 100dvh;
    width: 100%;
    /* Safe area support */
    padding-top: env(safe-area-inset-top);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
    padding-right: env(safe-area-inset-right);
  }
  
  /* Ensure html element uses full viewport */
  html {
    height: 100%;
    height: 100dvh;
    min-height: 100%;
    min-height: 100dvh;
    /* Prevent bounce scrolling on iOS */
    overscroll-behavior: none;
    -webkit-overflow-scrolling: touch;
  }

  /* Hide scrollbar for webkit browsers (Chrome, Safari) */
  body::-webkit-scrollbar {
    display: none;
  }

  /* Disable text highlighting/selection on mobile */
  /* Mobile-optimized scroll behavior */
  * {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
    -webkit-overflow-scrolling: touch;
  }

  /* Allow text selection for input fields and textareas */
  input,
  textarea,
  [contenteditable="true"] {
    -webkit-user-select: text;
    -moz-user-select: text;
    -ms-user-select: text;
    user-select: text;
  }

  /* Mobile button enhancements */
  /* Larger touch targets and better spacing */
  .mobile-button {
    padding: 0.875rem 1.25rem;
    font-size: 1rem;
    min-height: 48px;
  }

  /* Mobile input optimizations */
  /* Prevent zoom on input focus (iOS) */
  input, textarea, select {
    font-size: 16px; /* Prevents iOS zoom on focus */
  }

  /* Mobile menu/drawer optimizations */
  /* Full-width drawers on mobile */
  .mobile-drawer {
    width: 85vw;
    max-width: 400px;
  }

  /* Mobile toast positioning */
  /* Top positioning for mobile toasts */
  .mobile-toast {
    top: 1rem;
    left: 1rem;
    right: 1rem;
    width: auto;
  }

  /* Game canvas touch optimizations */
  /* Prevent default touch behaviors on game canvas */
  canvas.game-canvas {
    touch-action: none;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
  }

  /* Mobile-specific focus states */
  /* Larger focus indicators for touch */
  *:focus-visible {
    outline: 2px solid hsl(180 100% 50%);
    outline-offset: 3px;
  }

  /* Lobby Page Mobile Optimizations */
  /* Target lobby container specifically */
  .lobby-page {
    padding: 2rem 1rem 1rem 1rem !important;
    min-height: 100vh;
    min-height: 100dvh; /* Use dynamic viewport height for mobile */
  }

  /* Optimize lobby title spacing on mobile */
  .lobby-page > div:first-child {
    margin-bottom: 1.5rem !important;
    padding: 0 0.5rem;
  }

  /* Reduce title size on mobile */
  .lobby-page h1 {
    font-size: 1.60rem !important;
    line-height: 1.3;
    white-space: nowrap;
  }

  /* Optimize lobby grid gap on mobile */
  .lobby-page .max-w-4xl {
    gap: 1rem !important;
    width: 100%;
  }

  /* Stats card appears first on mobile */
  .lobby-page .grid > div:first-child {
    order: 1;
  }

  /* Tabs card appears second on mobile */
  .lobby-page .grid > div:nth-child(2),
  .lobby-page .grid > div[class*="col-span-2"] {
    order: 2;
  }

  /* STATS Card Mobile Optimizations */
  /* Mobile 3-column layout for Stats */
  .lobby-page .stats-mobile-layout {
    padding-top: 1.5rem;
    margin: 0;
    gap: 0 !important; /* Remove gap, use margins instead */
    align-items: stretch; /* Stretch columns to full height */
    justify-content: center;
    width: 100%;
    height: 100%;
    min-height: 100%;
    max-width: 100%;
    max-height: 100%;
    overflow: hidden;
    box-sizing: border-box;
    contain: layout;
  }

  /* Ensure Card and CardContent containers use full width and height */
  .lobby-page .grid > div:first-child {
    overflow: hidden;
    max-width: 100%;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    width: 100%;
    height: 100%;
    min-height: 100%;
  }

  /* Remove default CardContent padding and spacing on mobile for stats */
  .lobby-page .grid > div:first-child [class*="CardContent"] {
    overflow: hidden;
    max-width: 100%;
    box-sizing: border-box;
    width: 100%;
    height: 100%;
    min-height: 100%;
    display: flex;
    align-items: stretch; /* Stretch stats-mobile-layout to full height */
    justify-content: center;
    flex: 1 1 auto; /* Allow CardContent to grow and fill available space */
  }

  /* Override space-y-4 class for mobile stats layout */
  .lobby-page .grid > div:first-child [class*="CardContent"].space-y-4 {
    gap: 0 !important;
  }

  /* First column: Rotated STATS label - 10% width */
  .lobby-page .stats-label-column {
    flex: 0 0 5%;
    min-width: 0;
    max-width: 10%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    margin: 0;
    width: 100%;
    height: 100%;
    min-height: 100%;
    max-height: 100%;
    align-self: stretch; /* Ensure it stretches to container height */
    overflow: hidden;
    box-sizing: border-box;
  }

  /* Rotated STATS text - fill available height but stay contained */
  .lobby-page .stats-label-rotated {
    transform: rotate(-90deg);
    white-space: nowrap;
    transform-origin: center;
    line-height: 1;
    font-size: clamp(2rem, 100vh, 4rem) !important; /* Reduced to prevent overflow */
    height: 100%;
    max-height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 100%;
    max-width: 100%;
    /* overflow: hidden; */
    box-sizing: border-box;
  }

  /* Second column: HP, DMG, DEF - flexible width */
  .lobby-page .stats-column-1 {
    flex: 1 1 0;
    min-width: 0;
    max-width: 100%;
    width: 100%;
    height: 100%;
    min-height: 100%;
    max-height: 100%;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: center;
    align-self: stretch; /* Ensure it stretches to container height */
    padding: 0;
    margin: 0 !important;
    margin-left: 1rem !important; /* Gap between column 1 and 2 (matches grid gap) */
    overflow: hidden;
    box-sizing: border-box;
  }

  /* Third column: COINS, SPEED, VISION - flexible width */
  .lobby-page .stats-column-2 {
    flex: 1 1 0;
    min-width: 0;
    max-width: 100%;
    width: 100%;
    height: 100%;
    min-height: 100%;
    max-height: 100%;
    display: flex;
    flex-direction: column;
    align-items: stretch;
    justify-content: center;
    align-self: stretch; /* Ensure it stretches to container height */
    padding: 0;
    margin: 0 !important;
    margin-left: 1.5rem !important; /* Gap between column 2 and 3 (matches grid gap) */
    overflow: hidden;
    box-sizing: border-box;
  }

  /* Ensure stat rows use full width and proper alignment */
  .lobby-page .stats-column-1 > div,
  .lobby-page .stats-column-2 > div {
    width: 100%;
    max-width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 0;
    margin: 0;
    margin-bottom: 0.5rem;
  }

  /* Remove margin from last stat row in each column */
  .lobby-page .stats-column-1 > div:last-child,
  .lobby-page .stats-column-2 > div:last-child {
    margin-bottom: 0;
  }

  /* Override space-y-4 spacing in stat columns */
  .lobby-page .stats-column-1 .space-y-4,
  .lobby-page .stats-column-2 .space-y-4 {
    gap: 0 !important;
  }

  /* Stat names - left aligned */
  .lobby-page .stats-column-1 > div > span:first-child,
  .lobby-page .stats-column-2 > div > span:first-child {
    text-align: left;
    flex-shrink: 0;
  }

  /* Stat values - right aligned */
  .lobby-page .stats-column-1 > div > span:last-child,
  .lobby-page .stats-column-2 > div > span:last-child {
    text-align: right;
    flex-shrink: 0;
    margin-left: auto;
  }

  /* Ensure stat text doesn't overflow */
  .lobby-page .stats-column-1 > *,
  .lobby-page .stats-column-2 > * {
    max-width: 100%;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Set text size to text-xl for stats */
  .lobby-page .stats-mobile-layout .text-xl {
    font-size: 1.25rem !important; /* text-xl */
    line-height: 1.4;
  }

  /* Override any text-3xl classes in mobile stats layout */
  .lobby-page .stats-mobile-layout .font-mono.text-3xl,
  .lobby-page .stats-mobile-layout .text-3xl {
    font-size: 1.25rem !important; /* text-xl */
    line-height: 1.4;
  }

  /* Reduce spacing in stats card content - decrease line spacing */
  .lobby-page .stats-mobile-layout .space-y-4 {
    gap: 0.375rem !important;
  }

  /* Further reduce line spacing in Stats section rows */
  .lobby-page .stats-mobile-layout .flex.justify-between {
    margin-bottom: 0.125rem;
    line-height: 1.2;
  }

  /* Desktop stats card styles (keep existing) */
  .lobby-page .grid > div:first-child .space-y-4:not(.stats-mobile-layout) {
    gap: 0.375rem !important;
  }

  .lobby-page .grid > div:first-child .flex.justify-between:not(.stats-mobile-layout *) {
    margin-bottom: 0.125rem;
    line-height: 1.2;
  }

  /* Optimize stats card header - target first card's title */
  .lobby-page .grid > div:first-child h2,
  .lobby-page .grid > div:first-child [class*="text-primary"] {
    font-size: 1.25rem !important;
  }

  /* Tabs Card Mobile Optimizations */
  /* Reduce minimum height of tabs card on mobile - target second card in grid */
  .lobby-page .grid > div:nth-child(2),
  .lobby-page .grid > div[class*="col-span-2"] {
    min-height: 400px !important;
    max-height: calc(100vh - 12rem);
    max-height: calc(100dvh - 12rem);
  }

  /* Optimize tab buttons for touch */
  .lobby-page button[role="tab"],
  .lobby-page [role="tablist"] button {
    font-size: 0.625rem !important;
    padding: 0.60rem 0.5rem !important;
    min-height: 0px !important;
    line-height: 1.2;
  }

  /* Remove min-height for vendor station tab buttons */
  .vendor-station-tabs button[role="tab"] {
    min-height: 0px !important;
  }

  /* Reduce padding in tab content area */
  .lobby-page .p-6.flex-1 {
    padding: 1rem !important;
  }

  /* Optimize mission tab content spacing */
  .lobby-page [role="tabpanel"] .space-y-8 {
    gap: 1.5rem;
    padding: 1rem 0;
  }

  /* Optimize mission button size for mobile */
  .lobby-page .w-64.h-16 {
    width: 100% !important;
    max-width: 280px;
    height: 3.5rem !important;
  }

  .lobby-page .w-64.h-16.text-xl {
    font-size: 1.125rem !important;
  }

  /* Optimize inventory/loadout tab content */
  .lobby-page .max-h-\[400px\] {
    max-height: calc(100vh - 20rem) !important;
    max-height: calc(100dvh - 20rem) !important;
  }

  .lobby-page .space-y-4.max-h-\[400px\] {
    gap: 1rem;
  }

  /* Reduce padding in inventory sections */
  .lobby-page .border.p-3 {
    padding: 0.75rem !important;
  }

  /* Optimize inventory item text sizes within lobby tabs card */
  .lobby-page .grid > div:nth-child(2) .text-lg.font-mono,
  .lobby-page .grid > div[class*="col-span-2"] .text-lg.font-mono {
    font-size: 0.875rem !important;
  }

  .lobby-page .grid > div:nth-child(2) .text-2xl,
  .lobby-page .grid > div[class*="col-span-2"] .text-2xl {
    font-size: 1.25rem !important;
  }

  .lobby-page .grid > div:nth-child(2) .text-xl,
  .lobby-page .grid > div[class*="col-span-2"] .text-xl {
    font-size: 0.9375rem !important;
  }

  /* Optimize unequip buttons for touch */
  .lobby-page .grid > div:nth-child(2) .h-6.px-2,
  .lobby-page .grid > div[class*="col-span-2"] .h-6.px-2 {
    min-height: 36px !important;
    padding: 0.5rem 0.75rem !important;
  }

  .lobby-page .grid > div:nth-child(2) .h-6.px-2.text-xs,
  .lobby-page .grid > div[class*="col-span-2"] .h-6.px-2.text-xs {
    font-size: 0.75rem !important;
  }

  /* Optimize inventory filter buttons */
  .lobby-page .p-1\.5.border {
    padding: 0.625rem !important;
    min-width: 44px !important;
    min-height: 44px !important;
  }

  /* Optimize tab content headings */
  .lobby-page .grid > div:nth-child(2) .font-pixel.text-lg,
  .lobby-page .grid > div[class*="col-span-2"] .font-pixel.text-lg {
    font-size: 1rem !important;
  }

  /* Improve scrollable areas on mobile */
  .lobby-page .overflow-y-auto {
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
  }

  /* Optimize card content spacing in lobby tabs card */
  .lobby-page .grid > div:nth-child(2) .space-y-2,
  .lobby-page .grid > div[class*="col-span-2"] .space-y-2 {
    gap: 0.5rem;
  }

  .lobby-page .grid > div:nth-child(2) .space-y-0\.5,
  .lobby-page .grid > div[class*="col-span-2"] .space-y-0\.5 {
    gap: 0.125rem;
  }

  /* Code display on lobby page - single line with hidden overflow */
  .lobby-page .border-dashed {
    overflow-x: hidden !important;
  }

  .lobby-page .border-dashed p {
    overflow-x: hidden !important;
    white-space: nowrap !important;
    text-overflow: ellipsis !important;
  }

  .lobby-page .border-dashed span.break-all,
  .lobby-page .border-dashed span[class*="break-all"] {
    display: inline !important;
    overflow-x: hidden !important;
    white-space: nowrap !important;
    word-break: normal !important;
    overflow-wrap: normal !important;
  }

  /* Inventory section - stack title above buttons on mobile */
  .lobby-page .inventory-header-mobile {
    flex-direction: column !important;
    align-items: center !important;
    gap: 0.75rem !important;
  }

  .lobby-page .inventory-title-mobile {
    margin-bottom: 0 !important;
  }

  .lobby-page .inventory-buttons-mobile {
    width: 100% !important;
    justify-content: center !important;
  }

  /* Center "EQUIPPED" title on mobile */
  .lobby-page .border-primary\/30 > h4,
  .lobby-page .border-primary\/30 h4.font-pixel.text-lg.text-primary {
    text-align: center !important;
  }

  /* Toast tap-to-dismiss on mobile */
  .mobile-tap-to-dismiss {
    cursor: pointer;
    -webkit-tap-highlight-color: rgba(255, 255, 255, 0.1);
  }

  .mobile-tap-to-dismiss:active {
    opacity: 0.8;
    transform: scale(0.98);
  }

  /* Prevent tap-to-dismiss on buttons within toast */
  .mobile-tap-to-dismiss button,
  .mobile-tap-to-dismiss [role="button"] {
    cursor: pointer;
    pointer-events: auto;
  }

  /* Home page title background image - mobile styles */
  .home-title-bg {
    width: 100vw !important;
    height: 300px !important;
    left: 50% !important;
    top: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin: 0 !important;
  }

  /* Home page title container - full width on mobile */
  .home-title-container {
    width: 100vw !important;
    max-width: 100vw !important;
  }

  /* Home page title - mobile text size */
  .home-title-container .home-title {
    font-size: 2.5rem !important;
  }
}

